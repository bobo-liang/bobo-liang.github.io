---
layout: post
title: 'Cross-DomainWeakly-Supervised Object Detection through Progressive Domain Adaptation'
date: 2022-08-18
author: Poley
cover: '/assets/img/20220818/PDA.jpg'
tags: 论文阅读
---

参考博客：https://blog.csdn.net/hitzijiyingcai/article/details/84196763
本文是东京大学发表于 CVPR 2018 的工作，论文提出了基于域适应的弱监督学习策略，在源域拥有充足的实例级标注的数据，但目标域仅有少量图像级标注的数据的情况下，尽可能准确地实现对目标域数据的物体检测。

虽然深度学习技术在物体检测方面取得了巨大的成功，但目前的物体检测技术主要面向的对象是真实场景下的图像，而对于像水彩画这种非真实场景下的物体检测任务来说，一般很难获取大量带有标注的数据集，因此物体检测问题就变得比较棘手。

为解决这一问题，本文提出了基于域适应的弱监督学习策略，其可以描述为：（1）选取一个带有实例级标注的源域数据；（2）仅有图像级标注的目标域数据；（3）目标域数据的类别是源域数据类别的全集或子集。

论文的任务就是在源域拥有充足的实例级标注的数据，但目标域仅有少量图像级标注的数据的情况下，尽可能准确地实现对目标域数据的物体检测。这个任务的难点主要在于目标域没有实例级的标注，因此无法直接利用目标数据集对基于源数据集训练的模型进行微调。

针对这一问题，作者提出了两种解决方法：

1. 域迁移（domain transform，DT）：即利用图像转换技术，如CycleGAN将源域数据转换为和目标数据相似的带有实例级的图像；

2. 伪标记（pseudo-labeling，PL）：利用伪标记来对目标域数据产生伪实例级标注。两种方法如下图所示：

![](/assets/img/20220818/PDAF1.jpg)

本文为了研究这个问题，还自己建立了三个数据集，如下所示

![](/assets/img/20220818/PDAF2.jpg)

这里主要介绍作者的方法。

本文的方法下图所示，首先我们对源域图像进行域迁移训练得到域迁移图像，然后对于基于源域数据集训练得到的模型，再通过域迁移图像对模型进行微调，最后再使用通过伪标记方法获取的数据对模型进行进一步的微调。

![](/assets/img/20220818/PDAF3.jpg)

之所以要这么做，是因为Domain Transfer和Pseudo-Labeling对应的数据各有优劣。

通过Doamin Transfer获得的图片质量虽然不如目标域的高，但是标签是完全准确的。而伪标签获得的标注并不一定准确，但是其分布确确实实来自于目标域。

因此这里作者采用一种渐进的方法，先通过DT样本微调，再使用PL样本微调，最后实现良好的检测效果。

DT样本使用CycleGAN胜场，其使用源域和目标域的unpaired exaples来实现风格（颜色和纹理）的迁移。

在伪标签上，作者这里提出有监督检测器在目标域失效的原因主要是来自于和其他目标（以及背景）的混淆，而不是定位的不够准确。分析结果如下图所示。从图中可以看出基于DT 变换的微调模型能够很好的提高物体检测的性能，相对于DT来说，基于DT+PL 的微调策略能够进一步地提高检测的性能，尤其是在容易将物体误分成不相似类别物体的分类任务上（Sim将物体识别成与该物体类似但不相同的类别，Oth将物体识别成其他不相似的类别）。这也进一步说明了为何图像级标注可以提高物体检测的性能。（这里和3D检测的主要domain gap来自于尺寸的先验不同有明显区别）。

![](/assets/img/20220818/PDAF4.jpg)


最终的实验表明这种方法确实也起到一定的效果，笔者认为这种DT样本和PL样本在模型向目标域域适应过程中的这种训练的先后熟顺序是同样可以用于3D检测器的域适应当中