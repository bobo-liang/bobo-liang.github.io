I"é"<blockquote>
  <p>è®ºæ–‡é“¾æ¥ï¼š https://openaccess.thecvf.com/content/CVPR2021/html/Xie_Style-Based_Point_Generator_With_Adversarial_Rendering_for_Point_Cloud_Completion_CVPR_2021_paper.html</p>
</blockquote>

<p>æœ¬æ–‡æå‡ºäº†ä¸€ç§Style-based Point Generator with Adversarial Renderingã€‚</p>

<h1 id="introduction">Introduction</h1>
<p>å¦‚ä»Š3Dç‚¹äº‘å·²ç»éå¸¸å¸¸è§ï¼Œä½†æ˜¯ç”±äºæœ‰é™çš„ä¼ æ„Ÿå™¨åˆ†è¾¨ç‡ä»¥åŠé®æŒ¡ï¼ŒåŸå§‹çš„ç‚¹ä¸€èˆ¬æ˜¯ç¨€ç–å¹¶ä¸”ä¸å®Œæ•´çš„ã€‚å› æ­¤ä»ä¸å®Œæ•´çš„æ•°æ®ä¸­æ¨æµ‹å®Œæ•´çš„å½¢çŠ¶æ˜¯å¯¹ä¸‹æ¸¸ä»»åŠ¡æ˜¯å¾ˆå¿…è¦çš„ã€‚</p>

<p>ç°æœ‰çš„ç‚¹äº‘è¡¥å…¨æ–¹æ³•åŸºæœ¬éµç…§ä¸€ä¸ªencoder-decoderæ¨¡å‹ï¼Œå¹¶ä¸”ä½¿ç”¨å…·æœ‰é¡ºåºä¸å˜å½¢çš„Loss(Permutation invariant losses)ï¼Œæ¯”å¦‚Chamfer Distanceæˆ–è€…Earth Moverâ€™s Distanceã€‚</p>

<p>ç†è®ºä¸Šï¼Œç‚¹äº‘è¡¥å…¨ç½‘ç»œåº”è¯¥æ»¡è¶³ä¸‰ä¸ªéœ€æ±‚ï¼š</p>
<ul>
  <li>ä¿ç•™éƒ¨åˆ†è¾“å…¥ä¸­çš„å®Œæ•´ç»“æ„ä¿¡æ¯</li>
  <li>æœ‰è¶³å¤Ÿçš„æƒ³è±¡åŠ›æ¥é€šè¿‡å±€éƒ¨çš„çº¿ç´¢æ¥æ¨æ–­å®Œæ•´çš„å½¢çŠ¶</li>
  <li>å±€éƒ¨ç»“æœåº”è¯¥sharp accurate and free from å™ªå£°çš„æ„ŸæŸ“ã€‚ç°æœ‰æ–¹æ³•éƒ½ä¸æ»¡è¶³ä¸Šé¢é¸¡æ¡ï¼Œå› ä¸ºä»–ä»¬å¿½è§†äº†global contextï¼Œå¯¼è‡´æ¨¡å‹å¯¹äºç»“æ„ç»†èŠ‚çš„ä¿¡æ¯ä¸è¶³ã€‚</li>
</ul>

<p>äºæ˜¯æœ¬æ–‡æå‡ºäº† Style-based Point generator with Adversarial REndering, i.e., the SpareNetã€‚ä¸»è¦åŒ…å«ä¸‰ä¸ªæ¨¡å—ï¼š<strong>channel-attentive EdgeConv, Style-based Point Generator, and Adversarial Point Rendering</strong></p>

<ul>
  <li>ç”±äºPointNet PointNet++åªèƒ½æå–è¿‘é‚»çš„ä¿¡æ¯ï¼Œå› æ­¤æœ¬æ–‡ä½¿ç”¨edgeconvæ¥æ•æ‰æ›´å¤šçš„å…¨å±€ä¿¡æ¯ã€‚</li>
  <li>åŸå§‹çš„fold moduleä¸­ç›´æ¥concatenated é™åˆ¶äº†æ¨¡å‹çš„èƒ½åŠ›ï¼Œç”±äºä¸å½“çš„åˆ©ç”¨ç‰¹å¾ã€‚ä¸€æ¬¡ä½ è¿™é‡Œå°†å­¦ä¹ çš„ç‰¹å¾ä½œä¸ºstyle codesã€‚</li>
  <li>ä¸ºäº†äº§ç”Ÿè§†è§‰å‹å¥½çš„ï¼Œå°†ç‚¹äº‘æŠ•å½±åˆ°ä¸åŒè§†è§’çš„2Dï¼Œç„¶åæ¥è¿›è¡Œdiscriminateã€‚å¹¶äº§ç”Ÿå¯¹åº”çš„æ¢¯åº¦ç”¨äºå­¦ä¹ ã€‚</li>
</ul>

<p><img src="/assets/img/20210719/SpareNetF1.png" alt="" /></p>

<h1 id="the-sparenet">The SpareNet</h1>

<p>SpareNetçš„æ€»ä½“ç»“æ„å¦‚ä¸Šæ‰€ç¤ºï¼Œé¦–å…ˆå¯¹äºè¾“å…¥çš„éƒ¨åˆ†å¹¶ä¸”ä½åˆ†è¾¨ç‡çš„ç‚¹äº‘Xè¿›è¡Œç²—è¡¥å…¨ï¼Œå¾—åˆ°coarse point cloud Ycã€‚å…¶ä¸­ç”Ÿæˆç½‘ç»œé€šè¿‡å¯¹Xè¿›è¡Œç¼–ç å¾—åˆ°shape code gï¼Œå¹¶ä»¥æ­¤æ¥ç”Ÿæˆç‚¹äº‘ã€‚ä¹‹åå†ç»è¿‡ä¸€ä¸ªrefineé˜¶æ®µï¼Œå¼•å…¥adversarial point renderingæ¥è¿›ä¸€æ­¥ä¼˜åŒ–ç²—ç³™çš„ç‚¹äº‘ï¼Œå¾—åˆ°æœ€ç»ˆçš„å®Œæ•´ï¼Œé«˜åˆ†è¾¨ç‡çš„ï¼Œå…·æœ‰ä¸é”™visual qualityçš„ç‚¹äº‘ã€‚</p>

<h2 id="channel-attentive-edgeconv">Channel-Attentive EdgeConv</h2>

<p>æœ¬ç»“æ„å—åˆ°EdgeConvçš„å¯å‘ã€‚å¯¹äºè¾“å…¥ç‚¹äº‘ï¼Œæ ¹æ®æ¬§æ°è·ç¦»å¯»æ‰¾Kè¿‘é‚»ï¼Œä¹‹åæ ¹æ®ç‚¹ä»¥åŠä¸è¿‘é‚»çš„ç›¸å¯¹è·ç¦»å»ºç«‹edge$\left(p_{i}, q_{i}^{j}-p_{i}\right)$ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªMLPæ¥è®¡ç®—æ–°çš„ç‰¹å¾$\mathbf{F}<em>{1}\left(p</em>{i}, q_{i}^{j}-p_{i}\right)$</p>

<p>ä¸ºäº†è®¡ç®—globalç‰¹å¾ï¼Œå°†å…¨éƒ¨çš„è¾¹åšä¸€ä¸ªå…¨å±€å¹³å‡ï¼Œç„¶åé€åˆ°ç¬¬äºŒä¸ªMLPä¸­ï¼Œå¦‚ä¸‹ã€‚
\(\begin{equation}
\boldsymbol{\eta}=\sigma \circ \mathbf{F}_{2}\left[\frac{1}{k M} \times \sum_{i, j}^{M, k} e_{i}^{j}\right]
\end{equation}\)</p>

<p>ä¹‹åç”¨$\eta$å¯¹æ¯ä¸ªedgeè¿›è¡ŒåŠ æƒï¼Œä¹‹åé€šè¿‡max poolingå’Œreluæ¥å‰Šå‡ç»´åº¦ï¼Œå˜ä¸ºç‚¹ç‰¹å¾ã€‚æ€»ä½“å¦‚ä¸‹å›¾æ‰€ç¤º</p>

<p><img src="/assets/img/20210719/SpareNetF2.png" alt="" /></p>

<p>æœ¬æ–‡ä¸­çš„encoderåˆä¸Šè¿°çš„ CAE blocks å››ä¸ªä¸²è”ç»„æˆã€‚æœ€åå°†æ‰€æœ‰ç‚¹ç‰¹å¾catèµ·æ¥ï¼Œé€šè¿‡MLPæ¥å‰Šå‡ç»´åº¦ã€‚æœ€åçš„ shape code é€šè¿‡ global poolingå’Œ average poolingä¸¤è€…çš„ç»“æœcatå¾—åˆ°ã€‚</p>

<h2 id="style-based-point-generator">Style-based Point Generator</h2>

<p>ä¹‹å‰çš„foldingæ–¹æ³•å°†shape code tiled and concatenated with N 2D cooridnatesã€‚ä¹‹åå­¦ä¹ ä¸€ä¸ªæ˜ å°„å°†è¿™ç§ç»„åˆæ˜ å°„åˆ°3Dç©ºé—´ã€‚ä½†æ˜¯ä½œè€…è®¤ä¸ºè¿™æ ·shapecodeåªæ˜¯å†³å®šäº†è¾“å…¥ç‰¹å¾ä¹‹åçš„è¿™ä¸ªæ˜ å°„ï¼Œè€Œä¸èƒ½å½±å“è¾“å…¥ç‰¹å¾ä¹‹å‰çš„ä¸œè¥¿ã€‚å› æ­¤é™åˆ¶äº†å…¶è¡¨è¾¾3D è¡¨é¢çš„èƒ½åŠ›ã€‚</p>

<p>æ”¶åˆ°StyleGANçš„å¯å‘ï¼Œæå‡ºäº†ä¸€ä¸ª style-based foldingã€‚ç›´æ¥å°†shape code gæ³¨å…¥åˆ°ç”Ÿæˆå™¨Gçš„ä¸­é—´å±‚ï¼Œæ¥ä¿è¯æ›´å¹¿æ³›çš„ä¿¡æ¯è¢«èå…¥åˆ°ç‚¹äº‘ä¸­ã€‚</p>

<p>style-based folding çš„åŠŸèƒ½æ˜¯åœ¨shape code gçš„è°ƒåˆ¶ä¸‹ï¼Œå°†è¾“å…¥ç‰¹å¾è½¬æ¢ä¸ºæ–°çš„è¾“å‡ºç‚¹ç‰¹å¾ã€‚é¦–å…ˆï¼Œå¯¹è¾“å…¥ç‰¹å¾åšå½’ä¸€åŒ–</p>

\[\begin{equation}
\overline{\mathbf{h}}_{i n}=\frac{\mathbf{h}_{i n}-\mu_{\mathbf{h}_{i n}}}{\boldsymbol{\sigma}_{\mathbf{h}_{i n}}}
\end{equation}\]

<p>ä¹‹åé€šè¿‡shape code gæ¥åŠ¨æ€çš„åŠ æƒå’Œåç§»ã€‚
\(\begin{equation}
\mathbf{h}_{\text {out }}=\gamma_{\mathbf{g}} \otimes \overline{\mathbf{h}}_{i n}+\beta_{\mathbf{g}}
\end{equation}\)</p>

<p>ä¸ä¹‹å‰çš„ref[11,21]ä¸€æ ·ï¼ŒåŒæ ·éƒ¨ç½²Kä¸ªè¡¨é¢æ¥ç»„æˆä¸€ä¸ªå¤æ‚çš„å½¢çŠ¶ã€‚</p>

<p>å…¶ç»“æ„å¦‚ä¸‹æ‰€ç¤º</p>

<p><img src="/assets/img/20210719/SpareNetF3.png" alt="" /></p>

<h2 id="adversarial-point-rendering">Adversarial Point Rendering</h2>

<p>è¿™ä¸ªç»“æ„å¯ä»¥ä½¿å¾—refinementä¿è¯ä¸€ä¸ªæ›´å¥½çš„visual qualityã€‚è¿™é‡Œçš„Point rendering æŒ‡çš„æ˜¯ä¸€ä¸ªå®Œå…¨å¯å¾®çš„ï¼Œç«¯åˆ°ç«¯çš„ rendererã€‚å®ƒä½¿å¾—è®­ç»ƒçš„ç›‘ç£å¯ä»¥ä¸ä»…ä»…åœ¨point domainä¸Šï¼Œä¹Ÿå¯ä»¥å†image domainä¸Šã€‚</p>

<h3 id="renderer">Renderer</h3>

<p>å¯¹äºè¾“å…¥ç‚¹äº‘På’Œç›¸æœºPose vï¼Œpoint rendererçš„ç›®æ ‡å°±æ˜¯äº§ç”Ÿä¸€ä¸ª2Dæ·±åº¦å›¾ï¼Œæ¥ååº”Påœ¨vè§†è§’ä¸‹çš„å‡ ä½•æƒ…å†µã€‚è¿™ä¸ªæŠ•å½±çš„åŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé¦–å…ˆå°†æ¯ä¸ªç‚¹è½¬æ¢ä¸ºåˆ°æŠ•å½±å¹³é¢çš„æ·±åº¦ï¼Œå¹¶å°†æ¯ä¸ªç‚¹è§†ä¸ºä¸€ä¸ªå¹³æ»‘çš„äºŒç»´é«˜æ–¯åˆ†å¸ƒï¼Œåˆ†åˆ«æŠ•å½±åˆ°æŠ•å½±å¹³é¢ä¸Šï¼Œå¹¶å–maxå¾—åˆ°æœ€åçš„å›¾åƒã€‚å³</p>

\[\begin{equation}
I_{x, y}^{v}(P)=\max _{p \in P}\left\{\Psi\left(\left\|(x, y), \hat{p}^{v}\right\|_{2}\right) \times F_{p}, 0\right\}
\end{equation}\]

<p>Fæ˜¯ä¸€ä¸ªå½’ä¸€åŒ–å› å­ã€‚
<img src="/assets/img/20210719/SpareNetF4.png" alt="" /></p>

<p>ä¹‹åä½¿ç”¨multi-view renderer $/pi$ï¼ŒåŒæ—¶å°†ç‚¹æŠ•å½±åˆ°8ä¸ªä¸åŒçš„è§†è§’ï¼Œå¾—åˆ°8ä¸ªæ·±åº¦å›¾ã€‚å®éªŒä¸­2Dæ·±åº¦å›¾çš„å°ºå¯¸æ˜¯256*256ï¼Œ8ä¸ªç‚¹åˆ†åˆ«æ˜¯è¾¹é•¿ä¸º2çš„æ­£æ–¹ä½“çš„8ä¸ªè§’ã€‚</p>

<h3 id="refiner">Refiner</h3>
<p>åŒ…æ‹¬ä¸€ä¸ªminimum density sampling ä»¥åŠä¸€ä¸ªé›†æˆ residual residual networkï¼Œå¹¶åŠ å…¥äº†CAEæ¨¡å—ã€‚</p>

<h3 id="discriminator">Discriminator</h3>
<p>ä½¿ç”¨ cGAN strategy :the real sample is a concatenation of $\pi(Y_{gt})$ and$\pi(X)$ in channel dimension; the fake sample is a concatenationof  $\pi(Y_{r}^1)$ and$\pi(X)$ å¹¶ä½¿ç”¨ä¸€ç³»åˆ—çš„2D å·ç§¯ï¼Œ spectral normalizations and LeakyReLUã€‚</p>

<h2 id="training-losses">Training Losses</h2>

<p>ä½¿ç”¨Earth Moverâ€™s Distance ï¼Œè€Œä¸æ˜¯æ›´å¸¸è§çš„Chamfer Distanceã€‚åŒæ—¶å¯¹ç²—ç³™é‡å»ºçš„ç‚¹äº‘å’Œrefineçš„ç‚¹äº‘åšç›‘ç£ã€‚è¿™ç”¨æ¥è¡¡é‡è¾“å‡ºå’ŒGTä¹‹é—´çš„å·®å¼‚</p>

\[\begin{equation}
\mathcal{L}_{\text {rec }}=d_{\text {EMD }}\left(Y_{c}, Y_{g t}\right)+d_{\text {EMD }}\left(Y, Y_{g t}\right)
\end{equation}\]

<p>fidelity lossç”¨æ¥è¡¡é‡è¾“å…¥å’Œè¾“å‡ºçš„å·®å¼‚ï¼Œå³ç›®çš„æ˜¯ä¿ç•™è¾“å…¥çš„ç»“æ„ç‰¹å¾ã€‚
\(\begin{equation}
\mathcal{L}_{f d}=\frac{1}{|X|} \sum_{p \in X} \min _{q \in Y}\|p-q\|_{2}^{2}
\end{equation}\)</p>

<p>åŒæ—¶ä¹Ÿå¼•å…¥äº†å›¾åƒåŸŸçš„ç›‘ç£ï¼Œdepth map matching loss å’Œ feature matching lossã€‚</p>

\[\begin{equation}
\begin{array}{r}
\mathcal{L}_{\text {depth }}=\frac{1}{8 H W}\left\|\boldsymbol{\pi}\left(Y_{r}^{1}\right), \boldsymbol{\pi}\left(Y_{g t}\right)\right\|_{1} \\
\mathcal{L}_{\text {fea }}=\sum_{i}^{4} \frac{\alpha_{i}}{H_{i} W_{i} D_{i}}\left\|\mathrm{D}_{i}\left[\boldsymbol{\pi}\left(Y_{r}^{1}\right)\right], \mathrm{D}_{i}\left[\boldsymbol{\pi}\left(Y_{g t}\right)\right]\right\|_{2}^{2}
\end{array}
\end{equation}\]

<p>å¯¹ä¸Šè¿°LOSSåŠ æƒå¾—åˆ°æœ€ç»ˆçš„loss</p>

\[\begin{equation}
\begin{aligned}
\mathcal{L}=&amp; w_{r e c} \mathcal{L}_{r e c}+w_{f d} \mathcal{L}_{f d}+w_{\text {depth }} \mathcal{L}_{\text {depth }}+\\
&amp; w_{f e a} \mathcal{L}_{f e a}+w_{a d v} \mathcal{L}_{a d v}+w_{\exp } \mathcal{L}_{e x p}
\end{aligned}
\end{equation}\]

<h1 id="experiments">Experiments</h1>

<p><img src="/assets/img/20210719/SpareNetT1.png" alt="" /></p>

<p>æˆ‘ä¸ªäººè®¤ä¸ºç»“æœçš„æˆå›¾è¿˜æ˜¯æŒºæ¼‚äº®çš„</p>

<p><img src="/assets/img/20210719/SpareNetF5.png" alt="" /></p>

<h1 id="code">Code</h1>

<p>Ganç½‘ç»œçš„è¾“å…¥æ˜¯å‡åŒ€$[0,1]^2$çš„é‡‡æ ·ç½‘æ ¼ã€‚æ¯æœ‰ä¸€ä¸ªprimitivesï¼Œå°±è¾“å…¥ä¸€ä¸ªç½‘æ ¼ã€‚æ¯ä¸ªprimitiveså…±äº«ä¸€ä¸ªç”Ÿæˆç½‘ç»œï¼Œä¹Ÿå°±æ˜¯æ¯ä¸€ä¸ªgridå•ç‹¬è¾“å…¥ï¼Œäº§ç”ŸåŒæ ·æ•°é‡çš„3Dç‚¹ã€‚æ¯ä¸ªprimitivesäº§ç”Ÿçš„ç‚¹æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œæˆä¸ºæœ€ç»ˆçš„è¾“å…¥ã€‚ä¹Ÿå°±æ˜¯ä¸åŒçš„Primitivesä»£è¡¨äº†3då½¢çŠ¶çš„ä¸åŒå­ç»“æ„ã€‚</p>

<p>Style-based foldingåœ¨ä»£ç ä¸­è¡¨ç°ä¸º assign_adain_paramså‡½æ•°ï¼Œå…¶ç›´æ¥ä½¿ç”¨è¾“å…¥å˜é‡ä½œä¸ºä¸€ä¸ªå…¨è¿æ¥å±‚çš„æƒé‡ï¼Œå¦‚å›¾3æ‰€ç¤ºã€‚</p>

<p>åœ¨refineä¸­ï¼Œä½¿ç”¨äº†æ–‡çŒ®[21]ä¸­çš„MDSé‡‡æ ·ï¼Œä»¥åŠç›¸å…³çš„æ–¹æ³•ã€‚ç»è¿‡å¯¹ç”Ÿæˆç‚¹çš„é‡‡æ ·ï¼Œé€šè¿‡resç½‘ç»œé¢„æµ‹åç§»ï¼Œå¾—åˆ°refineçš„è¾“å‡ºã€‚é‡å¤ä¸¤éã€‚</p>

<p>LOSSå…¨éƒ¨ä½¿ç”¨emd lossï¼ŒåŒæ ·å‡ºè‡ªæ–‡çŒ®[21]ã€‚</p>

<p>Renderåœ¨ç¨‹åºé‡Œæ˜¯å¯é€‰çš„ã€‚ä¸¤ä¸ªRenderçš„lossæ˜¯é€šè¿‡åˆ¤åˆ«å™¨å»ºç«‹ï¼Œè€ŒéæŸç§åº¦é‡ã€‚</p>
:ET